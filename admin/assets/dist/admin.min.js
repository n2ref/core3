((e,t)=>{"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Admin=t()})(this,function(){var t=Object.create(null),o=(t["db_list.html"]='<ul class="admin-list p-0 m-0"> <li class="list-group-item p-0 mb-3"> <div class="fw-bold"><%= _(\'Тип\') %></div> <%= type %> (<%= version %>) </li> <li class="list-group-item p-0 mb-3"> <div class="fw-bold"><%= _(\'Адрес\') %></div> <%= host %> </li> <li class="list-group-item p-0 mb-3"> <div class="fw-bold"><%= _(\'Имя базы\') %></div> <%= name %> (<%= size %> Mb) </li> </ul>',t["php_list.html"]='<ul class="admin-list p-0 m-0"> <li class="list-group-item p-0 mb-3"> <div class="fw-bold"><%= _(\'Версия\') %></div> <%= version %> </li> <li class="list-group-item p-0 mb-3"> <div class="fw-bold"><%= _(\'Лимит памяти\') %></div> <%= memLimit %> Mb </li> <li class="list-group-item p-0 mb-3"> <div class="fw-bold"><%= _(\'Максимальный размер для отправки\') %></div> <%= uploadMaxFilesize %> Mb </li> <li class="list-group-item p-0 mb-3"> <div class="fw-bold"><%= _(\'Максимальное время выполнения\') %></div> <%= maxExecutionTime %> <%= _(\'сек\') %> </li> <li class="list-group-item p-0 mb-3"> <div class="fw-bold"><%= _(\'Расширения\') %></div> <span class="text-muted"><%= extensions.join(\', \') %></span> </li> </ul>',{_container:null,index:function(e){this._container=e,this.loadIndex(e)},loadIndex:function(t){t=t||this._container,Core.menu.preloader.show(),fetch("admin/index/").then(function(e){Core.menu.preloader.hide(),e.ok?e.json().then(function(e){e.error_message?$(t).html(CoreUI.info.danger(e.error_message,Admin._("Ошибка"))):Core.tools.isObject(e)?o._renderIndex(e,t):$(t).html(CoreUI.info.danger(Admin._("Некорректные данные для отображения на странице"),Admin._("Ошибка")))}).catch(function(e){console.error(e),$(t).html(CoreUI.info.danger(Admin._("Некорректные данные для отображения на странице"),Admin._("Ошибка")))}):CoreUI.notice.danger(Admin._("Ошибка загрузки данных для отображения страницы"))}).catch(console.error)},_renderIndex:function(e,t){var o=r.getPanelCommon(),l=(o.setContent(r.getTableCommon(e.common)),r.getLayoutSys()),a=(l.setItemContent("chartCpu",r.getChartCpu(null==(a=e.sys)?void 0:a.cpuLoad)),l.setItemContent("chartMem",r.getChartMem(null==(a=e.sys)||null==(a=a.memory)?void 0:a.mem_percent)),l.setItemContent("chartSwap",r.getChartSwap(null==(a=e.sys)||null==(a=a.memory)?void 0:a.swap_percent)),l.setItemContent("chartDisks",r.getChartDisk(e.disks)),r.getPanelSys()),l=(a.setContent([l,"<br><br>",r.getTableSys(e.sys)]),r.getLayoutPhpDb()),n=r.getPanelPhp(e.php),s=r.getPanelDb(e.db),n=(l.setItemContent("php",n),l.setItemContent("db",s),r.getPanelDisks()),s=(n.setContent(r.getTableDisks(e.disks)),r.getPanelNetwork()),e=(s.setContent(r.getTableNet(e.net)),r.getLayoutAll()),o=(e.setItemContent("main",[o,a,l,n,s]),e.render());$(t).html(o),e.initEvents()}}),r={getPanelCommon:function(){return CoreUI.panel.create({title:n._("Общие сведения"),controls:[{type:"button",content:'<i class="bi bi-info"></i>',onClick:l.showRepo,attr:{class:"btn btn-outline-secondary"}},{type:"button",content:'<i class="bi bi-arrow-clockwise"></i>',onClick:function(){return o.loadIndex()},attr:{class:"btn btn-outline-secondary"}}]})},getPanelSys:function(){return CoreUI.panel.create({title:n._("Системная информация"),controls:[{type:"button",content:'<i class="bi bi bi-list-ul"></i>',onClick:l.showSystemProcessList,attr:{class:"btn btn-outline-secondary"}}]})},getPanelPhp:function(e){return Core.tools.isObject(e)?(e=ejs.render(t["php_list.html"],{version:e.version,memLimit:Core.tools.convertBytes(e.memLimit,"mb"),maxExecutionTime:e.maxExecutionTime,uploadMaxFilesize:Core.tools.convertBytes(e.uploadMaxFilesize,"mb"),extensions:e.extensions,_:n._}),CoreUI.panel.create({title:"Php",content:e,controls:[{type:"button",content:'<i class="bi bi-info"></i>',onClick:l.showPhpInfo,attr:{class:"btn btn-outline-secondary"}}]})):null},getPanelDb:function(e){return Core.tools.isObject(e)?(e=ejs.render(t["db_list.html"],{_:n._,type:e.type,version:e.version,host:e.host,name:e.name,size:Core.tools.convertBytes(e.size,"mb")}),CoreUI.panel.create({title:n._("База данных"),wrapperType:"card",content:e,controls:[{type:"button",content:'<i class="bi bi-info"></i>',onClick:l.showDbVariablesList,attr:{class:"btn btn-outline-secondary"}},{type:"button",content:'<i class="bi bi-plugin"></i>',onClick:l.showDbProcessList,attr:{class:"btn btn-outline-secondary"}}]})):null},getPanelDisks:function(){return CoreUI.panel.create({title:n._("Использование дисков")})},getPanelNetwork:function(){return CoreUI.panel.create({title:n._("Сеть")})},getTableCommon:function(e){return Core.tools.isObject(e)?CoreUI.table.create({class:"table-hover table-striped",overflow:!0,theadTop:-30,showHeaders:!1,columns:[{type:"text",field:"title",width:200,sortable:!0,attr:{class:"bg-body-tertiary border-end fw-medium"}},{type:"html",field:"value",sortable:!0},{type:"html",field:"actions",width:"45%",sortable:!0}],records:[{title:n._("Версия ядра"),value:e.version,actions:'<small class="text-muted">'.concat(n._("Обновлений нет"),'</small><br>\n                         <small class="text-muted">').concat(n._("последняя проверка"),' 04.07.2023</small> \n                         <button class="btn btn-sm btn-link text-secondary btn-update-core">\n                             <i class="bi bi-arrow-clockwise"></i> ').concat(n._("проверить"),"\n                         </button>")},{title:n._("Установленные модули"),value:e.countModules,actions:'<small class="text-success fw-bold">'.concat(n._("Доступны новые версии"),' (1)</small> \n                         <a href="#/admin/modules" class="text-success-emphasis fw-bold"><small>').concat(n._("посмотреть"),'</small></a><br>\n                         <small class="text-muted">').concat(n._("последняя проверка"),' 04.07.2023</small> \n                         <button class="btn btn-sm btn-link text-secondary btn-update-modules">\n                             <i class="bi bi-arrow-clockwise"></i> ').concat(n._("проверить"),"\n                         </button>")},{title:n._("Пользователи системы"),value:"".concat(n._("Всего"),": ").concat(e.countUsers," <br> \n                         ").concat(n._("Активных за текущий день"),": ").concat(e.countUsersActiveDay," <br> \n                         ").concat(n._("Активных сейчас"),": ").concat(e.countUsersActiveNow),actions:"",_meta:{fields:{value:{attr:{class:"lh-sm",colspan:2}},actions:{show:!1}}}},{title:n._("Кэш системы"),value:e.cacheType,actions:'<button class="btn btn-outline-secondary" onclick="Admin.index.clearCache()">\n                             <i class="bi bi-trash"></i> '.concat(n._("Очистить"),"\n                         </button>")}]}):null},getTableSys:function(e){var t,o,l,a;return Core.tools.isObject(e)?(t="-",Array.isArray(e.loadAvg)&&e.loadAvg.length&&(o=a=l="",2<=e.loadAvg[0]?l="text-danger":1<=e.loadAvg[0]&&(l="text-warning-emphasis"),2<=e.loadAvg[1]?a="text-danger":1<=e.loadAvg[1]&&(a="text-warning-emphasis"),2<=e.loadAvg[2]?o="text-danger":1<=e.loadAvg[2]&&(o="text-warning-emphasis"),t='<span class="'.concat(l,'">').concat(e.loadAvg[0],'</span> <small class="text-muted">(1 min)</small> / ')+'<span class="'.concat(a,'">').concat(e.loadAvg[1],'</span> <small class="text-muted">(5 min)</small> / ')+'<span class="'.concat(o,'">').concat(e.loadAvg[2],'</span> <small class="text-muted">(15 min)</small>')),a=l="",80<=(null==(o=e.memory)?void 0:o.mem_percent)?l="text-danger":40<=(null==(o=e.memory)?void 0:o.mem_percent)&&(l="text-warning-emphasis"),80<=(null==(o=e.memory)?void 0:o.swap_percent)?a="text-danger":40<=(null==(o=e.memory)?void 0:o.swap_percent)&&(a="text-warning-emphasis"),e.memory.mem_total=Core.tools.formatNumber(e.memory.mem_total),e.memory.mem_used=Core.tools.formatNumber(e.memory.mem_used),e.memory.swap_total=Core.tools.formatNumber(e.memory.swap_total),e.memory.swap_used=Core.tools.formatNumber(e.memory.swap_used),CoreUI.table.create({class:"table-hover table-striped",overflow:!0,showHeaders:!1,columns:[{type:"text",field:"title",width:200,sortable:!0,attr:{class:"bg-body-tertiary border-end fw-medium"}},{type:"html",field:"value",sortable:!0}],records:[{title:"Host",value:null==(o=e.network)?void 0:o.hostname},{title:"OS name",value:e.osName},{title:"System time",value:e.systemTime},{title:"System uptime",value:"".concat(e.uptime.days," ").concat(n._("дней")," ").concat(e.uptime.hours," ").concat(n._("часов")," ").concat(e.uptime.min," ").concat(n._("минут"))},{title:"Cpu name",value:e.cpuName},{title:"Load avg",value:t},{title:"Memory",value:"".concat(n._("Всего")," ").concat(e.memory.mem_total," Mb / ").concat(n._("используется"),' <span class="').concat(l,'">').concat(e.memory.mem_used,"</span> Mb")},{title:"Swap",value:"".concat(n._("Всего")," ").concat(e.memory.swap_total," Mb / ").concat(n._("используется"),' <span class="').concat(a,'">').concat(e.memory.swap_used,"</span> Mb")},{title:"DNS",value:null==(o=e.network)?void 0:o.dns},{title:"Gateway",value:null==(t=e.network)?void 0:t.gateway}]})):null},getTableDisks:function(e){return Array.isArray(e)&&e.length?e.map(function(e){var t,o,l,a,n;Core.tools.isObject(e)&&(t=Core.tools.convertBytes(e.available,"Gb"),o=Core.tools.convertBytes(e.total,"Gb"),l=Core.tools.convertBytes(e.used,"Gb"),a=Core.tools.round((e.total-e.used)/e.total*100,1),n=Core.tools.round(e.percent,1),e.used="".concat(l," Gb <small>").concat(n,"%</small>"),e.total="".concat(o," Gb"),e.available=t<=5?'<b class="text-danger">'.concat(t,"Gb <small>").concat(a,"%</small></b>"):5<t&&t<=20?'<b style="color: #EF6C00">'.concat(t,"Gb <small>").concat(a,"%</small></b>"):"".concat(t,"Gb <small>").concat(a,"%</small>"))}):e=[],CoreUI.table.create({class:"table-hover table-striped",overflow:!0,columns:[{type:"text",field:"mount",label:n._("Директория"),width:150,sortable:!0},{type:"text",field:"device",label:n._("Устройство"),width:200,sortable:!0},{type:"text",field:"fs",label:n._("Файловая система"),width:140,sortable:!0},{type:"text",field:"total",label:n._("Всего"),width:120,sortable:!0},{type:"html",field:"used",label:n._("Использовано"),width:120,sortable:!0},{type:"html",field:"available",label:n._("Свободно"),width:120,sortable:!0}],records:e})},getTableNet:function(e){return Array.isArray(e)&&e.length?e.map(function(e){Core.tools.isObject(e)&&("up"===e.status?e.status='<span class="text-success">up</span>':e.status='<span class="text-danger">down</span>')}):e=[],CoreUI.table.create({class:"table-hover table-striped",overflow:!0,columns:[{type:"text",field:"interface",label:"Interface",width:150,sortable:!0},{type:"text",field:"ipv4",label:"IPv4",width:150,sortable:!0},{type:"text",field:"ipv6",label:"IPv6",width:200,minWidth:200,sortable:!0,attr:{style:"word-break: break-all"}},{type:"text",field:"mac",label:"Mac",sortable:!0},{type:"text",field:"duplex",label:"Duplex",width:150,sortable:!0},{type:"html",field:"status",label:"Status",width:150,sortable:!0}],records:e})},getTableProcesslist:function(){return CoreUI.table.create({class:"table-hover table-striped",overflow:!0,theme:"compact",recordsRequest:{url:"admin/index/system/process",method:"GET"},header:[{type:"out",left:[{type:"total"},{type:"divider",width:30},{field:"command",type:"filter:text",attr:{placeholder:"Command"}},{type:"filterClear"}],right:[{type:"button",content:'<i class="bi bi-arrow-clockwise"></i>',onClick:function(e,t){return t.reload()}}]}],columns:[{field:"pid",label:"Pid",width:80,sortable:!0,type:"text"},{field:"user",label:"User",width:90,sortable:!0,type:"text"},{field:"group",label:"Group",width:90,sortable:!0,type:"text"},{field:"start",label:"Start",width:200,sortable:!0,type:"text"},{field:"cpu",label:"Cpu",width:50,sortable:!0,type:"text"},{field:"mem",label:"Mem",width:50,sortable:!0,type:"text"},{field:"size",label:"Size",width:90,sortable:!0,type:"text"},{field:"command",label:"Command",minWidth:150,sortable:!0,attr:{style:"word-break: break-all"},type:"text",noWrap:!0,noWrapToggle:!0}]})},getTableDbVars:function(){return CoreUI.table.create({class:"table-hover table-striped",overflow:!0,theme:"compact",recordsRequest:{url:"admin/index/db/variables",method:"GET"},header:[{type:"out",left:[{field:"search",type:"filter:text",attr:{placeholder:"Поиск"},autoSearch:!0},{type:"filterClear"}]}],columns:[{type:"text",field:"name",label:"Name",width:"50%",sortable:!0,attr:{style:"word-break: break-all"}},{type:"text",field:"value",label:"Value",minWidth:150,sortable:!0,attr:{style:"word-break: break-all"},noWrap:!0,noWrapToggle:!0}]})},getTableDbConnections:function(){return CoreUI.table.create({class:"table-hover table-striped",overflow:!0,theme:"compact",recordsRequest:{url:"admin/index/db/connections",method:"GET"},header:[{type:"out",left:[{type:"total"}],right:[{type:"button",content:'<i class="bi bi-arrow-clockwise"></i>',onClick:function(e,t){return t.reload()}}]}],columns:[{field:"Id",label:"Id",sortable:!0,type:"text"},{field:"User",label:"User",sortable:!0,type:"text"},{field:"Host",label:"Host",sortable:!0,type:"text"},{field:"db",label:"db",sortable:!0,type:"text"},{field:"Time",label:"Time",sortable:!0,type:"text"},{field:"State",label:"State",sortable:!0,type:"text"},{field:"Info",label:"Info",sortable:!0,type:"text"}]})},getLayoutAll:function(){return CoreUI.layout.create({sizes:{sm:{justify:"start"},md:{justify:"center"}},items:[{id:"main",width:1024,minWidth:400,maxWidth:"100%"}]})},getLayoutSys:function(){return CoreUI.layout.create({justify:"around",direction:"row",items:[{id:"chartCpu",width:200},{id:"chartMem",width:200},{id:"chartSwap",width:200},{id:"chartDisks",width:200}]})},getLayoutPhpDb:function(){return CoreUI.layout.create({items:[{id:"php",widthColumn:12,sizes:{lg:{fill:!1,widthColumn:6}}},{id:"db",widthColumn:12,sizes:{lg:{fill:!1,widthColumn:6}}}]})},getChartCpu:function(e){return Core.tools.isNumber(e)?CoreUI.chart.create({labels:["CPU"],datasets:[{type:"radialBar",name:"CPU",data:[Core.tools.round(e,1)]}],options:{type:"pie",width:"100%",height:200,enabled:{legend:!1,tooltip:!1},theme:{colorScheme:"custom",customColors:["#7EB26D"]},style:{labels:!1,labelColor:"#ffffff",startAngle:-120,endAngle:120,size:50,fill:90,total:{label:"Cpu",labelSize:"14px",valueSize:"16px",color:"#333"}}}}):null},getChartMem:function(e){return Core.tools.isNumber(e)?CoreUI.chart.create({labels:["Mem"],datasets:[{type:"radialBar",name:"Mem",data:[Core.tools.round(e,1)]}],options:{type:"pie",width:"100%",height:200,enabled:{legend:!1,tooltip:!1},theme:{colorScheme:"custom",customColors:["#7EB26D"]},style:{labels:!1,labelColor:"#ffffff",startAngle:-120,endAngle:120,size:50,fill:90,total:{label:"Mem",labelSize:"14px",valueSize:"16px",color:"#333"}}}}):null},getChartSwap:function(e){return Core.tools.isNumber(e)?CoreUI.chart.create({labels:["Swap"],datasets:[{type:"radialBar",name:"Swap",data:[Core.tools.round(e,1)]}],options:{type:"pie",width:"100%",height:200,enabled:{legend:!1,tooltip:!1},theme:{colorScheme:"custom",customColors:["#ffcc80"]},style:{startAngle:-120,endAngle:120,size:50,fill:90,total:{label:"Swap",labelSize:"14px",valueSize:"16px",color:"#333"}}}}):null},getChartDisk:function(e){var t,o,l;return Array.isArray(e)&&(t=[],o=[],l=[],e.map(function(e){Core.tools.isObject(e)&&e.hasOwnProperty("mount")&&e.hasOwnProperty("percent")&&Core.tools.isString(e.mount)&&Core.tools.isNumber(e.percent)&&(t.push("Disk "+e.mount),o.push(Core.tools.round(e.percent)),e.percent<40?l.push("#7EB26D"):40<=e.percent&&e.percent<80?l.push("#ffcc80"):l.push("#ef9a9a"))}),t.length)?CoreUI.chart.create({labels:t,datasets:[{type:"radialBar",name:"Disks",data:o}],options:{type:"pie",width:"100%",height:200,enabled:{legend:!1},theme:{colorScheme:"custom",customColors:l},style:{labels:!0,labelColor:"#ffffff",startAngle:-120,endAngle:120,size:50,fill:90,total:{label:"Disks",labelSize:"14px",valueSize:"16px",color:"#333"}}}}):null}},l={_baseUrl:"admin/index",clearCache:function(){CoreUI.alert.warning(n._("Очистить кэш системы?"),n._("Это временные файлы которые помогают системе работать быстрее. При необходимости их можно удалять"),{buttons:[{text:n._("Отмена")},{text:n._("Очистить"),type:"warning",click:function(){Core.menu.preloader.show(),$.ajax({url:l._baseUrl+"/system/cache/clear",method:"post",dataType:"json",success:function(e){"success"!==e.status?CoreUI.notice.danger(e.error_message||n._("Ошибка. Попробуйте обновить страницу и выполнить это действие еще раз.")):CoreUI.notice.success(n._("Кэш очищен"))},error:function(e){CoreUI.notice.danger(n._("Ошибка. Попробуйте обновить страницу и выполнить это действие еще раз."))},complete:function(){Core.menu.preloader.hide()}})}}]})},showRepo:function(){CoreUI.modal.showLoad(n._("Система"),l._baseUrl+"/system/repo")},showPhpInfo:function(){CoreUI.modal.showLoad(n._("Php Info"),l._baseUrl+"/php/info")},showDbProcessList:function(){CoreUI.modal.show(n._("Database connections"),r.getTableDbConnections(),{size:"xl"})},showDbVariablesList:function(){CoreUI.modal.show(n._("Database variables"),r.getTableDbVars(),{size:"xl"})},showSystemProcessList:function(){CoreUI.modal.show(n._("System process list"),r.getTableProcesslist(),{size:"xl"})}},n={lang:{},init:function(e){Core.setTranslates("admin",n.lang);var t=new Core.router({"/index(|/)":[o,"index"],"/modules.*":"","/settings.*":"","/users.*":"","/logs.*":""}),t=(t.setBaseUrl("/admin"),t.getRouteMethod(location.hash.substring(1)));t?(t.prependParam(e),t.run()):$(e).html(CoreUI.info.warning(n._("Страница не найдена"),n._("Упс...")))},_:function(e,t){return Core.translate("admin",e,t)}},e={showRecord:function(t,e){var o=t.data.message||"",l="";if(t.data.context)try{l=JSON.stringify(JSON.parse(t.data.context),null,4),l="<pre>"+(l=l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(e){var t="number";return/^"/.test(e)?t=/:$/.test(e)?"key":"string":/true|false/.test(e)?t="boolean":/null/.test(e)&&(t="null"),'<span class="json-'+t+'">'+e+"</span>"}))+"</pre>"}catch(e){l=t.data.context}o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>"),l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>"),e.expandRecordContent(t.index,"<b>Message:</b> "+o+"<br><b>Context:</b> "+l,!0)},reloadTable:function(e){e.reload()}},a={_baseUrl:"admin/modules",upgradeRepo:function(){var l=CoreUI.form.get("admin_modules_repo").getControls()[0],a=$(".item-repo-upgrade");l.lock(),Core.menu.preloader.show(),fetch(this._baseUrl+"/repo/upgrade",{method:"POST"}).then(function(e){var t;Core.menu.preloader.hide(),e.ok?(a.empty(),a.addClass("upgrade-repo-container border border-1 rounded-2 p-2 w-100 bg-body-tertiary"),a.after('<div class="repo-load"><div class="spinner-border spinner-border-sm"></div> '+Admin._("Загрузка...")+"</div>"),t=e.body.getReader(),function o(){t.read().then(function(e){var t=e.done,e=e.value;t?(l.unlock(),$(".repo-load").remove()):(t=(new TextDecoder).decode(e),a.append(t),a[0].scrollTop=a[0].scrollHeight,o())}).catch(function(e){l.unlock(),$(".repo-load").remove(),console.error("Error reading stream:",e)})}()):l.unlock()})},installVersion:function(e,t){CoreUI.alert.warning(Admin._("Установить версию %s?",[t]),Admin._("Установка будет начата сразу после подтверждения"),{buttons:[{text:Admin._("Отмена")},{text:Admin._("Установить"),type:"warning",click:function(){}}]})},downloadVersionFile:function(e){new Core.router({"admin/modules":a.downloadVersionFile,"admin/modules/{id:d+}":{method:a.downloadVersionFile}}).getRouteMethod().run()}},s={onSaveRole:function(e,o){o.privileges={},CoreUI.table.get("admin_roles_role_access").getData().map(function(e){var t;e.is_access&&(t=e.module,e.section&&(t+="_"+e.section),o.privileges.hasOwnProperty(t)||(o.privileges[t]=[]),o.privileges[t].push(e.name))})},switchAccess:function(e,t,l){fetch("admin/roles/access",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({rules:[{module:e.data.module,section:e.data.section,name:e.data.name,role_id:Number(t),is_active:l.checked?1:0}]})}).then(function(t){function o(e){l.checked=!l.checked;var t=Admin._("Ошибка. Попробуйте обновить страницу и выполнить это действие еще раз.");e.json().then(function(e){CoreUI.notice.danger(e.error_message||t)}).catch(function(){CoreUI.notice.danger(t)})}t.ok?t.text().then(function(e){0<e.length&&o(t)}):o(t)})},setAccessRoleAll:function(e){CoreUI.table.get("admin_roles_role_access").getRecords().map(function(e){e.fields.hasOwnProperty("is_access")&&e.fields.is_access.setActive()})},setRejectRoleAll:function(){CoreUI.table.get("admin_roles_role_access").getRecords().map(function(e){e.fields.hasOwnProperty("is_access")&&e.fields.is_access.setInactive()})},setAccessAll:function(e){this._setRoleAccess(e,!0).then(function(){Core.menu.reload()})},setRejectAll:function(e){this._setRoleAccess(e,!1).then(function(){Core.menu.reload()})},_setRoleAccess:function(t,o){return new Promise(function(l,e){fetch("admin/roles/access/all",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({role_id:t,is_access:o?"1":"0"})}).then(function(t){function o(e){var t=Admin._("Ошибка. Попробуйте обновить страницу и выполнить это действие еще раз.");e.json().then(function(e){CoreUI.notice.danger(e.error_message||t)}).catch(function(){CoreUI.notice.danger(t)})}t.ok?t.text().then(function(e){0<e.length?o(t):l()}):o(t)})})}},i={loginUser:function(e){CoreUI.alert.create({type:"warning",title:Admin._("Войти под выбранным пользователем?"),buttons:[{text:Admin._("Отмена")},{text:Admin._("Да"),type:"warning",click:function(){Core.menu.preloader.show(),$.ajax({url:"admin/users/login",method:"post",dataType:"json",data:{user_id:e},success:function(e){"success"!==e.status?CoreUI.alert.danger(e.error_message||Admin._("Ошибка. Попробуйте обновить страницу и выполнить это действие еще раз.")):location.href="/"},error:function(e){CoreUI.notice.danger(Admin._("Ошибка. Попробуйте обновить страницу и выполните это действие еще раз."))},complete:function(){Core.menu.preloader.hide()}})}}]})}};return n.index=l,n.logs=e,n.modules=a,n.roles=s,n.users=i,n.lang.en={"Директория":"Директория","Устройство":"Устройство","Файловая система":"Файловая система","Всего":"Всего","Использовано":"Использовано","Свободно":"Свободно"},n.lang.en={"Директория":"Директория","Устройство":"Устройство","Файловая система":"Файловая система","Всего":"Всего","Использовано":"Использовано","Свободно":"Свободно"},n});
//# sourceMappingURL=admin.min.js.map
